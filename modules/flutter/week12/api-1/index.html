<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>12.1 API Calls and Async | WDPGF</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Web Developers Practical Guide to Flutter">
    
    <link rel="preload" href="/wdpgf-content/assets/css/0.styles.460e0d01.css" as="style"><link rel="preload" href="/wdpgf-content/assets/js/app.cbf162c6.js" as="script"><link rel="preload" href="/wdpgf-content/assets/js/2.4b40a9e9.js" as="script"><link rel="preload" href="/wdpgf-content/assets/js/35.312c1cb0.js" as="script"><link rel="preload" href="/wdpgf-content/assets/js/4.c80ae3ea.js" as="script"><link rel="preload" href="/wdpgf-content/assets/js/5.69c388f8.js" as="script"><link rel="prefetch" href="/wdpgf-content/assets/js/10.faa297a2.js"><link rel="prefetch" href="/wdpgf-content/assets/js/11.6ab30f31.js"><link rel="prefetch" href="/wdpgf-content/assets/js/12.ea3bd107.js"><link rel="prefetch" href="/wdpgf-content/assets/js/13.1f7ad682.js"><link rel="prefetch" href="/wdpgf-content/assets/js/14.9b8f8fc6.js"><link rel="prefetch" href="/wdpgf-content/assets/js/15.6fe13460.js"><link rel="prefetch" href="/wdpgf-content/assets/js/16.bedaca54.js"><link rel="prefetch" href="/wdpgf-content/assets/js/17.83643e45.js"><link rel="prefetch" href="/wdpgf-content/assets/js/18.7ae88e43.js"><link rel="prefetch" href="/wdpgf-content/assets/js/19.391e464f.js"><link rel="prefetch" href="/wdpgf-content/assets/js/20.6e675515.js"><link rel="prefetch" href="/wdpgf-content/assets/js/21.555efd5a.js"><link rel="prefetch" href="/wdpgf-content/assets/js/22.bd9ff5cb.js"><link rel="prefetch" href="/wdpgf-content/assets/js/23.0b07adfc.js"><link rel="prefetch" href="/wdpgf-content/assets/js/24.ffafac43.js"><link rel="prefetch" href="/wdpgf-content/assets/js/25.e351e069.js"><link rel="prefetch" href="/wdpgf-content/assets/js/26.856008dc.js"><link rel="prefetch" href="/wdpgf-content/assets/js/27.26a7c315.js"><link rel="prefetch" href="/wdpgf-content/assets/js/28.4e7276d3.js"><link rel="prefetch" href="/wdpgf-content/assets/js/29.ad47cec4.js"><link rel="prefetch" href="/wdpgf-content/assets/js/3.3e390df9.js"><link rel="prefetch" href="/wdpgf-content/assets/js/30.1b89040d.js"><link rel="prefetch" href="/wdpgf-content/assets/js/31.e3b16aa5.js"><link rel="prefetch" href="/wdpgf-content/assets/js/32.80376440.js"><link rel="prefetch" href="/wdpgf-content/assets/js/33.b96246ae.js"><link rel="prefetch" href="/wdpgf-content/assets/js/34.02a912ec.js"><link rel="prefetch" href="/wdpgf-content/assets/js/36.121bb1ed.js"><link rel="prefetch" href="/wdpgf-content/assets/js/37.4259ddc9.js"><link rel="prefetch" href="/wdpgf-content/assets/js/38.c4440fe4.js"><link rel="prefetch" href="/wdpgf-content/assets/js/39.8d286942.js"><link rel="prefetch" href="/wdpgf-content/assets/js/40.ae9780fc.js"><link rel="prefetch" href="/wdpgf-content/assets/js/41.3c55780b.js"><link rel="prefetch" href="/wdpgf-content/assets/js/6.548c35f3.js"><link rel="prefetch" href="/wdpgf-content/assets/js/7.33d05a48.js"><link rel="prefetch" href="/wdpgf-content/assets/js/8.2542ae12.js"><link rel="prefetch" href="/wdpgf-content/assets/js/9.f32450ae.js">
    <link rel="stylesheet" href="/wdpgf-content/assets/css/0.styles.460e0d01.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wdpgf-content/" class="home-link router-link-active"><img src="/wdpgf-content/mad-d-logo-sm.png" alt="WDPGF" class="logo"> <span class="site-name can-hide">WDPGF</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/wdpgf-content/modules/" class="nav-link router-link-active">
  Chapter List
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/wdpgf-content/modules/" class="nav-link router-link-active">
  Chapter List
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Chapter List</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wdpgf-content/modules/chapter1/" class="sidebar-link">1. Tooling, Environment, Setup</a></li><li><a href="/wdpgf-content/modules/chapter2/" class="sidebar-link">2. What you Need to Know About Dart</a></li><li><a href="/wdpgf-content/modules/chapter3/" class="sidebar-link">3. Handling Project Assets</a></li><li><a href="/wdpgf-content/modules/chapter4/" class="sidebar-link">4. Core Flutter Widgets</a></li><li><a href="/wdpgf-content/modules/chapter5/" class="sidebar-link">5. Columns, Lists, and Grids</a></li><li><a href="/wdpgf-content/modules/chapter6/" class="sidebar-link">6. Layouts, Context, and State</a></li><li><a href="/wdpgf-content/modules/chapter7/" class="sidebar-link">7. Styling and Themeing</a></li><li><a href="/wdpgf-content/modules/chapter8/" class="sidebar-link">8. App Navigation and Routing</a></li><li><a href="/wdpgf-content/modules/chapter9/" class="sidebar-link">9. Futures, APIs, and Async data</a></li><li><a href="/wdpgf-content/modules/chapter10/" class="sidebar-link">10. Data Persistence and State Management</a></li><li><a href="/wdpgf-content/modules/chapter11/" class="sidebar-link">11. Forms and User Inputs</a></li><li><a href="/wdpgf-content/modules/chapter12/" class="sidebar-link">12. Gestures and User Interactions</a></li><li><a href="/wdpgf-content/modules/chapter13/" class="sidebar-link">13. Hooks, LifeCycle and UI Updates</a></li><li><a href="/wdpgf-content/modules/chapter14/" class="sidebar-link">14. Animations</a></li><li><a href="/wdpgf-content/modules/chapter15/" class="sidebar-link">15. Launcher Icons and Screens &amp; Production</a></li><li><a href="/wdpgf-content/modules/chapter16/" class="sidebar-link">16. Beyond iOS &amp; Android</a></li><li><a href="/wdpgf-content/modules/chapter17/" class="sidebar-link">17. Where to Go Next?</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title blue">
    Flutter Apps
  </div> <h1>12.1 API Calls and Async</h1> <div class="underdev no">Module Still Under Development</div></header> <h2 id="futures"><a href="#futures" class="header-anchor">#</a> Futures</h2> <p>Futures are part of <code>Dart:core</code>. They looks a lot like JS Promises. The three states that a Future object can be in are: <code>uncompleted</code>, <code>completed with data</code>, or <code>completed with error</code>.</p> <p>There are a number of other classes that we use that return Futures. HTTP requests return a Future. <code>SharedPreferences.getInstance</code> returns a Future. We will be talking more about <code>SharedPreferences</code>
next week when talking about Data Persistence.</p> <div title="Futures in Dart" class="video-player"><p>Futures in Dart</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/OTS-ap9_aXc" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <p>Here is an example that shows a <code>Future</code> created by an HTTP Request.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token class-name">ElevatedButton</span><span class="token punctuation">(</span>
  onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> myFuture <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'https://example.com/some/image.jpg'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    myFuture<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>resp<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">_myHandleResponse</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catchError</span><span class="token punctuation">(</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Caught </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">err</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">whenComplete</span><span class="token punctuation">(</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//just like finally in JS</span>
      <span class="token comment">//runs after either then() or catchError()</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  child<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Click to load'</span></span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>Here is an example of a generic <code>Future</code>, think JS Promise.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:async'</span></span><span class="token punctuation">;</span> <span class="token comment">//important to remember to import this</span>
<span class="token comment">// dart:async gives us `Future`</span>

<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> myFuture <span class="token operator">=</span> <span class="token class-name">Future</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//code here will run second</span>
    <span class="token keyword">return</span> <span class="token string-literal"><span class="token string">'hello world'</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//code here will run first</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>A <code>Future.value()</code> is like the JavaScript <code>Promise.resolve()</code>.</p> <p>A <code>Future.error(Exception())</code> is like the JavaScript <code>Promise.reject(new Error())</code>.</p> <p>A <code>then().catchError( (err){ })</code> is like the JavaScript <code>then().catch( function(err){ })</code>.</p> <p>One of the common things we do in JS is to wrap a setTimeout in a Promise to use as a function that delays something in our code from running. In Dart, a <code>Future</code> has a method called <code>delayed</code> which
does exactly this. The example below will run the Duration Widget for 5 seconds and then call the second parameter function as if it were <code>Future.value(12)</code>.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">final</span> myFuture <span class="token operator">=</span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span>int<span class="token punctuation">&gt;</span></span><span class="token punctuation">.</span><span class="token function">delayed</span><span class="token punctuation">(</span>
  <span class="token class-name">Duration</span><span class="token punctuation">(</span>seconds<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">12</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
<span class="token comment">//notice the comma after Duration(), not a semi-colon</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>If you want, you can chain a <code>.then()</code> on to the end of that call to <code>Future.delayed</code>. If you want to handle errors on your <code>Future</code> (and you always should), then chain a <code>.catchError((err) { })</code>
after the <code>.then()</code>. Unlike JavaScript Promises, you can add a <code>.catchError</code> after each <code>.then</code>.</p> <p>At the end of your chain of <code>then</code> and <code>catchError</code> functions you can add a <code>.whenComplete()</code> to the end of the chain. It will always run after either the last <code>.then</code> or <code>.catchError</code>.</p> <p><a href="https://api.flutter.dev/flutter/dart-async/Future/Future.html" target="_blank" rel="noopener noreferrer">Future reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="async-await"><a href="#async-await" class="header-anchor">#</a> Async / Await</h2> <div title="async await in Dart" class="video-player"><p>async await in Dart</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/SmTCmDMi4BY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="allowfullscreen"></iframe></div> <p>In Dart the <code>async</code> and <code>await</code> works like <code>async / await</code> in JavaScript. You can use a series of <code>await</code> wrapped commands instead of chained <code>then</code> methods.</p> <h2 id="json-encode-and-decode"><a href="#json-encode-and-decode" class="header-anchor">#</a> JSON encode and decode</h2> <p>In our Flutter apps, to work with JSON being sent and received from an API, we need to import the (<code>data:convert</code> library](https://api.flutter.dev/flutter/dart-convert/dart-convert-library.html). When
writing a Flutter app, we automatically have access to anything in the <code>dart:core</code> library but other dart functionality and classes need to be imported.</p> <p>The <code>dart:convert</code> library includes lots of methods for converting between different formats of strings. We will be focused on the <code>JsonDecoder</code> and <code>JsonEncoder</code> classes.</p> <p><a href="https://api.flutter.dev/flutter/dart-convert/JsonDecoder-class.html" target="_blank" rel="noopener noreferrer">JsonDecoder class reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://api.flutter.dev/flutter/dart-convert/JsonEncoder-class.html" target="_blank" rel="noopener noreferrer">JsonEncoder class reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">//Simple HttpHelper class for making http requests</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:convert'</span></span><span class="token punctuation">;</span>
<span class="token comment">//gives us jsonDecode and jsonEncode</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:async'</span></span><span class="token punctuation">;</span>
<span class="token comment">//gives us Future</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:http/http.dart'</span></span> <span class="token operator">as</span> http<span class="token punctuation">;</span>
<span class="token comment">//we can give names to the packages we import</span>

<span class="token keyword">class</span> <span class="token class-name">HttpHelper</span> <span class="token punctuation">{</span>
  <span class="token comment">//skipping over any variable declarations for domain, path, params</span>

  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&gt;</span></span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token class-name">String</span> keyword<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token comment">//we could create our own custom object in the Future</span>

    <span class="token class-name">Uri</span> uri <span class="token operator">=</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">https</span><span class="token punctuation">(</span>domain<span class="token punctuation">,</span> path<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Uri in dart:core</span>
    <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Response</span> response <span class="token operator">=</span> <span class="token keyword">await</span> http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//http get request</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token function">jsonDecode</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//convert the json String in the response body</span>
    <span class="token comment">// into a Map object with String keys.</span>
    <span class="token keyword">return</span> data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>Here is the <a href="https://docs.flutter.dev/development/data-and-backend/json" target="_blank" rel="noopener noreferrer">Dart Guide to working with JSON<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. It talks about how to serialize and deserialize JSON.</p> <h2 id="ide-api-library-framework-and-sdk"><a href="#ide-api-library-framework-and-sdk" class="header-anchor">#</a> IDE, API, Library, Framework, and SDK</h2> <p>Ever wonder what the difference is between these five things - <code>IDE</code>, <code>API</code>, <code>Library</code>, <code>Framework</code>, and <code>SDK</code>?</p> <p>While there are different interpretations with different types of programming and disagreements between developers about the finer points, here is a general reference to what each is:</p> <p><strong>IDE</strong> is an Integrated Development Environment. This is a text editor on steroids. It has features that help developers write and compile their code, as well as, manage all their projects. Usually,
they have integrations with Source Control (Git) too.</p> <p><strong>API</strong> is an Application Programming Interface. This is a group of functions or server-side endpoints that let another program access a service or data-source.</p> <p><strong>Library</strong> is one or more files that use the same programming language as your project. They can be included in your project to provide pre-tested code that will speed up your development work.</p> <p><strong>Framework</strong> is similar to a library but will typically <em>also</em> include UI components, design assets, best practice guidance, and conventions to follow.</p> <p><strong>SDK</strong> is a software development kit. It tends to be the largest of all of these. It will often include a library or framework. Most importantly, it will include tools that you need in order to
develop for your target platforms, such as a compiler or testing tools.</p> <h2 id="http-package"><a href="#http-package" class="header-anchor">#</a> Http Package</h2> <p>The <code>http</code> package comes from the <a href="https://pub.dev/" target="_blank" rel="noopener noreferrer">pub.dev<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> site. Here is the link to the <a href="https://pub.dev/packages/http" target="_blank" rel="noopener noreferrer">http package<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and here is the
<a href="https://pub.dev/documentation/http/latest/" target="_blank" rel="noopener noreferrer">API documentation for http<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Dart core has <a href="https://api.flutter.dev/flutter/dart-core/Uri-class.html" target="_blank" rel="noopener noreferrer">a <code>Uri</code> class<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for creating or parsing URLs from Strings.</p> <p>To make a single <code>http</code>request from your app you can use the <code>http.post</code>, <code>http.get</code>, <code>http.delete</code>, <code>http.head</code>, <code>http.patch</code>, or <code>http.put</code> methods.</p> <p>If you want to make a series of requests then you can use an async await function with an <code>http.Client()</code> object. Create the client and use the client as a wrapper for all the get and post calls. Use
<code>await</code> in front of each of the calls to wait for the response before moving to the next one.</p> <h4 id="alternative"><a href="#alternative" class="header-anchor">#</a> Alternative</h4> <p>Here is the <a href="https://dart.dev/guides/libraries/library-tour#using-http-resources-with-httprequest" target="_blank" rel="noopener noreferrer">Dart guide to working with HTTP Requests<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. This guide talks about using the <code>HttpRequest</code> package
that is part of Dart, instead of the <code>http</code> package that we imported from <code>pub.dev</code>.</p> <h2 id="custom-data-model-classes"><a href="#custom-data-model-classes" class="header-anchor">#</a> Custom Data Model Classes</h2> <p>When you make a <code>fetch</code> call in a web app we use <code>JSON.parse()</code> to turn the JSON string into a plain JavaScript object. In the <code>dart</code> example above we were passing the result of the JSON parsing into
a simple <code>Map</code> like this: <code>Map&lt;String, dynamic&gt; data = json.decode(response.body);</code>.</p> <p>Consider that the bare bones approach.</p> <p>In languages that are more strongly typed, it is considered a best practice to pass that <code>Map</code> into a custom class object that is specifically designed for our data. We can filter out properties that
we don't want, we can do validation on the data, we can provide default values.</p> <p>This process is similar to what we did in our PWA when we made a call to <code>TMDB</code> api and then called the <code>Array.map</code> method to only keep the properties that we wanted to save in the IndexedDB.</p> <p>Applying this idea in <code>dart</code> we will create a class and create a variable for each of the properties we want and assign them the proper data types.</p> <p>Create a folder inside <code>/lib</code> called <code>data</code>. This is where we will put our <code>HttpHelper</code> class as well as our custom data object classes.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">// /lib/data/movie.dart</span>

<span class="token keyword">class</span> <span class="token class-name">Movie</span> <span class="token punctuation">{</span>
  int id<span class="token punctuation">;</span>
  <span class="token class-name">String</span> title<span class="token punctuation">;</span>
  <span class="token class-name">String</span> overview<span class="token punctuation">;</span>
  <span class="token class-name">DateTime</span><span class="token operator">?</span> release_date<span class="token punctuation">;</span> <span class="token comment">//nullable</span>
  <span class="token class-name">String</span><span class="token operator">?</span> poster_path<span class="token punctuation">;</span> <span class="token comment">//nullable because null is allowed here</span>
  double popularity<span class="token punctuation">;</span>

  <span class="token class-name">Movie</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>overview<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>release_date<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>poster_path<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>popularity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Those six variables that we declared will all be available as instance properties of the Movie object. The constructor function will accept a generic Map object and it will destructure the various
named property values from the Map based on the String keys in the Map.</p> <p>So, this would work but we have no default values or validation. To solve that we are going to add a new <code>named constructor</code> method inside our <code>Movie</code> class. All constructors will create an instance
of your class. You are allowed to have ONE unnamed constructor but as many unnamed constructors as you want.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token class-name">Movie</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> dataMap<span class="token punctuation">)</span><span class="token punctuation">{</span>
  id <span class="token operator">=</span> dataMap<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'id'</span></span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token number">0</span><span class="token punctuation">;</span>
  title <span class="token operator">=</span> dataMap<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'title'</span></span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string-literal"><span class="token string">''</span></span><span class="token punctuation">;</span>
  overview <span class="token operator">=</span> dataMap<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'overview'</span></span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string-literal"><span class="token string">''</span></span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'release_date'</span></span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    release_date <span class="token operator">=</span> <span class="token class-name">DateTime</span><span class="token punctuation">.</span><span class="token function">tryParse</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'release_date'</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
    release_date <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  poster_path <span class="token operator">=</span> dataMap<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'poster_path'</span></span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token string-literal"><span class="token string">'default_image.jpg'</span></span><span class="token punctuation">;</span>
  popularity <span class="token operator">=</span> dataMap<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'popularity'</span></span><span class="token punctuation">]</span> <span class="token operator">?</span><span class="token operator">?</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// return Movie(id: id,</span>
  <span class="token comment">//  title: title,</span>
  <span class="token comment">//  overview: overview,</span>
  <span class="token comment">//  release_date: release_date,</span>
  <span class="token comment">//  poster_path: poster_path,</span>
  <span class="token comment">//  popularity: popularity);</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>This way we are accepting the full map of data that comes from the API and we are going to assign only the values we want from the Map to our instance variables. We are also using the nullish
coalescing operator to check if any of them are null. If they are then we are assigning a default value. We could do more data validation or custom errors here too.</p> <p>The return statement cannot be used if it is a basic named constructor. Constructors are not allowed to have return statements. However, we can add one and actually use that return statement that
calls the default constructor by adding the keyword <code>factory</code> in front of the <code>Movie.fromJson(</code></p> <h2 id="working-with-datetime"><a href="#working-with-datetime" class="header-anchor">#</a> Working with DateTime</h2> <p><a href="https://api.dart.dev/stable/2.16.1/dart-core/DateTime-class.html" target="_blank" rel="noopener noreferrer">Reference for the core DateTime class<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="httphelper"><a href="#httphelper" class="header-anchor">#</a> HttpHelper</h2> <p>The final step is to build our own helper class to use with api calls. For each API that we are going to use we could create a separate helper class. Inside each helper class we could create a new
function for each endpoint that we want to use.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">// /lib/data/http_helper.dart</span>

<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'./movie.dart'</span></span><span class="token punctuation">;</span> <span class="token comment">//our movie data object class</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:http/http.dart'</span></span> <span class="token operator">as</span> http<span class="token punctuation">;</span>  <span class="token comment">//to make http calls</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:async'</span></span><span class="token punctuation">;</span> <span class="token comment">//for Future</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:convert'</span></span><span class="token punctuation">;</span> <span class="token comment">//for JSON to Map conversion</span>

<span class="token keyword">class</span> <span class="token class-name">HttpHelper</span> <span class="token punctuation">{</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> domain <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'example.com'</span></span><span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'api/v2/endpoint'</span></span><span class="token punctuation">;</span>
  <span class="token keyword">final</span> <span class="token class-name">String</span> apiKey <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'YourApiKeyForThisApi'</span></span><span class="token punctuation">;</span>

  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Movie</span><span class="token punctuation">&gt;</span></span> <span class="token function">searchMovies</span><span class="token punctuation">(</span><span class="token class-name">String</span> keyword<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token comment">//these are the querystring params</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token string-literal"><span class="token string">'keyword'</span></span><span class="token punctuation">:</span> keyword<span class="token punctuation">,</span>
      <span class="token string-literal"><span class="token string">'lang'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">'en'</span></span><span class="token punctuation">,</span>
      <span class="token string-literal"><span class="token string">'apikey'</span></span><span class="token punctuation">:</span> apiKey
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">//create the URL for the endpoint with parameters</span>
    <span class="token comment">//we are assuming that our API call is returning one object</span>
    <span class="token class-name">Uri</span> uri <span class="token operator">=</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">https</span><span class="token punctuation">(</span>domain<span class="token punctuation">,</span> path<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//make the fetch call to the api</span>
    <span class="token class-name"><span class="token namespace">http<span class="token punctuation">.</span></span>Response</span> result <span class="token operator">=</span> <span class="token keyword">await</span> http<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//convert the json string response into a Map</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token function">jsonDecode</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span>body<span class="token punctuation">)</span> <span class="token operator">as</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>
    <span class="token comment">//pass the Map to the Movie.fromJson method for validation and default values</span>
    <span class="token comment">//and removal of unwanted properties</span>
    <span class="token class-name">Movie</span> movie <span class="token operator">=</span> <span class="token class-name">Movie</span><span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//return the movie object that we got from the API</span>
    <span class="token keyword">return</span> movie<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//add other functions to handle other endpoints</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><h2 id="flutter-cookbook"><a href="#flutter-cookbook" class="header-anchor">#</a> Flutter Cookbook</h2> <p>In the Flutter.dev website cookbook section they have a simple example of using the <code>http</code> package and a custom data class to fetch and use JSON data from an online API.
<a href="https://docs.flutter.dev/cookbook/networking/fetch-data" target="_blank" rel="noopener noreferrer">Flutter fetch cookbook recipe<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="what-to-do-this-week"><a href="#what-to-do-this-week" class="header-anchor">#</a> What to do this week</h2> <div class="custom-block warning"><p class="custom-block-title">TODO Things to do before next week</p> <ul><li>Work on <a href="/wdpgf-content/modules/assignments/exer/">Flutter App 2</a></li> <li>Read all the notes for modules 12.1, 12.2, 13.1</li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/3/2023, 3:32:24 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/wdpgf-content/assets/js/app.cbf162c6.js" defer></script><script src="/wdpgf-content/assets/js/2.4b40a9e9.js" defer></script><script src="/wdpgf-content/assets/js/35.312c1cb0.js" defer></script><script src="/wdpgf-content/assets/js/4.c80ae3ea.js" defer></script><script src="/wdpgf-content/assets/js/5.69c388f8.js" defer></script>
  </body>
</html>
