<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>13.1 Data Persistence | WDPGF</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Web Developers Practical Guide to Flutter">
    
    <link rel="preload" href="/wdpgf-content/assets/css/0.styles.460e0d01.css" as="style"><link rel="preload" href="/wdpgf-content/assets/js/app.cbf162c6.js" as="script"><link rel="preload" href="/wdpgf-content/assets/js/2.4b40a9e9.js" as="script"><link rel="preload" href="/wdpgf-content/assets/js/37.4259ddc9.js" as="script"><link rel="preload" href="/wdpgf-content/assets/js/4.c80ae3ea.js" as="script"><link rel="prefetch" href="/wdpgf-content/assets/js/10.faa297a2.js"><link rel="prefetch" href="/wdpgf-content/assets/js/11.6ab30f31.js"><link rel="prefetch" href="/wdpgf-content/assets/js/12.ea3bd107.js"><link rel="prefetch" href="/wdpgf-content/assets/js/13.1f7ad682.js"><link rel="prefetch" href="/wdpgf-content/assets/js/14.9b8f8fc6.js"><link rel="prefetch" href="/wdpgf-content/assets/js/15.6fe13460.js"><link rel="prefetch" href="/wdpgf-content/assets/js/16.bedaca54.js"><link rel="prefetch" href="/wdpgf-content/assets/js/17.83643e45.js"><link rel="prefetch" href="/wdpgf-content/assets/js/18.7ae88e43.js"><link rel="prefetch" href="/wdpgf-content/assets/js/19.391e464f.js"><link rel="prefetch" href="/wdpgf-content/assets/js/20.6e675515.js"><link rel="prefetch" href="/wdpgf-content/assets/js/21.555efd5a.js"><link rel="prefetch" href="/wdpgf-content/assets/js/22.bd9ff5cb.js"><link rel="prefetch" href="/wdpgf-content/assets/js/23.0b07adfc.js"><link rel="prefetch" href="/wdpgf-content/assets/js/24.ffafac43.js"><link rel="prefetch" href="/wdpgf-content/assets/js/25.e351e069.js"><link rel="prefetch" href="/wdpgf-content/assets/js/26.856008dc.js"><link rel="prefetch" href="/wdpgf-content/assets/js/27.26a7c315.js"><link rel="prefetch" href="/wdpgf-content/assets/js/28.4e7276d3.js"><link rel="prefetch" href="/wdpgf-content/assets/js/29.ad47cec4.js"><link rel="prefetch" href="/wdpgf-content/assets/js/3.3e390df9.js"><link rel="prefetch" href="/wdpgf-content/assets/js/30.1b89040d.js"><link rel="prefetch" href="/wdpgf-content/assets/js/31.e3b16aa5.js"><link rel="prefetch" href="/wdpgf-content/assets/js/32.80376440.js"><link rel="prefetch" href="/wdpgf-content/assets/js/33.b96246ae.js"><link rel="prefetch" href="/wdpgf-content/assets/js/34.02a912ec.js"><link rel="prefetch" href="/wdpgf-content/assets/js/35.312c1cb0.js"><link rel="prefetch" href="/wdpgf-content/assets/js/36.121bb1ed.js"><link rel="prefetch" href="/wdpgf-content/assets/js/38.c4440fe4.js"><link rel="prefetch" href="/wdpgf-content/assets/js/39.8d286942.js"><link rel="prefetch" href="/wdpgf-content/assets/js/40.ae9780fc.js"><link rel="prefetch" href="/wdpgf-content/assets/js/41.3c55780b.js"><link rel="prefetch" href="/wdpgf-content/assets/js/5.69c388f8.js"><link rel="prefetch" href="/wdpgf-content/assets/js/6.548c35f3.js"><link rel="prefetch" href="/wdpgf-content/assets/js/7.33d05a48.js"><link rel="prefetch" href="/wdpgf-content/assets/js/8.2542ae12.js"><link rel="prefetch" href="/wdpgf-content/assets/js/9.f32450ae.js">
    <link rel="stylesheet" href="/wdpgf-content/assets/css/0.styles.460e0d01.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wdpgf-content/" class="home-link router-link-active"><img src="/wdpgf-content/mad-d-logo-sm.png" alt="WDPGF" class="logo"> <span class="site-name can-hide">WDPGF</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/wdpgf-content/modules/" class="nav-link router-link-active">
  Chapter List
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/wdpgf-content/modules/" class="nav-link router-link-active">
  Chapter List
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Chapter List</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wdpgf-content/modules/chapter1/" class="sidebar-link">1. Tooling, Environment, Setup</a></li><li><a href="/wdpgf-content/modules/chapter2/" class="sidebar-link">2. What you Need to Know About Dart</a></li><li><a href="/wdpgf-content/modules/chapter3/" class="sidebar-link">3. Handling Project Assets</a></li><li><a href="/wdpgf-content/modules/chapter4/" class="sidebar-link">4. Core Flutter Widgets</a></li><li><a href="/wdpgf-content/modules/chapter5/" class="sidebar-link">5. Columns, Lists, and Grids</a></li><li><a href="/wdpgf-content/modules/chapter6/" class="sidebar-link">6. Layouts, Context, and State</a></li><li><a href="/wdpgf-content/modules/chapter7/" class="sidebar-link">7. Styling and Themeing</a></li><li><a href="/wdpgf-content/modules/chapter8/" class="sidebar-link">8. App Navigation and Routing</a></li><li><a href="/wdpgf-content/modules/chapter9/" class="sidebar-link">9. Futures, APIs, and Async data</a></li><li><a href="/wdpgf-content/modules/chapter10/" class="sidebar-link">10. Data Persistence and State Management</a></li><li><a href="/wdpgf-content/modules/chapter11/" class="sidebar-link">11. Forms and User Inputs</a></li><li><a href="/wdpgf-content/modules/chapter12/" class="sidebar-link">12. Gestures and User Interactions</a></li><li><a href="/wdpgf-content/modules/chapter13/" class="sidebar-link">13. Hooks, LifeCycle and UI Updates</a></li><li><a href="/wdpgf-content/modules/chapter14/" class="sidebar-link">14. Animations</a></li><li><a href="/wdpgf-content/modules/chapter15/" class="sidebar-link">15. Launcher Icons and Screens &amp; Production</a></li><li><a href="/wdpgf-content/modules/chapter16/" class="sidebar-link">16. Beyond iOS &amp; Android</a></li><li><a href="/wdpgf-content/modules/chapter17/" class="sidebar-link">17. Where to Go Next?</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><header><div class="section-title blue">
    Flutter Apps
  </div> <h1>13.1 Data Persistence</h1> <div class="underdev no">Module Still Under Development</div></header> <h2 id="shared-preferences"><a href="#shared-preferences" class="header-anchor">#</a> Shared Preferences</h2> <p><code>SharedPreferences</code> in Flutter are a lot like <code>SessionStorage</code> in the browser. You create a String key for each value you want to save and then save a value associated with that key.</p> <p>The primary differences are:</p> <ul><li>that you don't have to worry about other apps or webpages interfering with your key names because all the values are connected to your app and the code that you are writing.</li> <li>When you save or retrieve the value, you need to know what the datatype is for the information that you are saving.</li> <li>The read write operations for <code>SharedPreferences</code> are asynchronous so we need to use <code>Future</code> and possibly <code>async</code> and <code>await</code>.</li> <li>While the data might exist the next time you launch the app, there is no guarantee.</li></ul> <p>To use <code>SharedPreferences</code> we need to import the dart package <a href="https://pub.dev/packages/shared_preferences" target="_blank" rel="noopener noreferrer">shared_preferences from pub.dev<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Add <code>shared_preferences: ^2.2.2</code> to your <code>pubspec.yaml</code> dependencies list and run <code>flutter pub get</code> (if VSCode does not run it for you).</p> <p>Then you can import it at the top of any file that needs it.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:shared_preferences/shared_preferences.dart'</span></span><span class="token punctuation">;</span>

<span class="token comment">//inside an async function we will access the SharedPreferences storage for our app</span>
<span class="token keyword">final</span> prefs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token class-name">SharedPreferences</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Here is the <a href="https://pub.dev/documentation/shared_preferences/latest/" target="_blank" rel="noopener noreferrer">shared_preferences reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Once you have a reference to the <code>SharedPreferences</code> storage instance for your app then you can start saving data. The data that you save must be one of the following types: boolean, string, integer,
double, or List of Strings.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">//To SAVE values use these methods</span>
<span class="token comment">// Save an integer value to 'counter' key.</span>
<span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'counter'</span></span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Save an boolean value to 'repeat' key.</span>
<span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setBool</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'repeat'</span></span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Save an double value to 'decimal' key.</span>
<span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setDouble</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'decimal'</span></span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Save an String value to 'action' key.</span>
<span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'action'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'Start'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Save an list of strings to 'items' key.</span>
<span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setStringList</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'items'</span></span><span class="token punctuation">,</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'Earth'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'Moon'</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'Sun'</span></span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>To read the values from your <code>SharedPreferences</code> instance</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">// Try reading data from the 'counter' key. If it doesn't exist, returns null.</span>
<span class="token keyword">final</span> int<span class="token operator">?</span> counter <span class="token operator">=</span> prefs<span class="token punctuation">.</span><span class="token function">getInt</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'counter'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Try reading data from the 'repeat' key. If it doesn't exist, returns null.</span>
<span class="token keyword">final</span> bool<span class="token operator">?</span> repeat <span class="token operator">=</span> prefs<span class="token punctuation">.</span><span class="token function">getBool</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'repeat'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Try reading data from the 'decimal' key. If it doesn't exist, returns null.</span>
<span class="token keyword">final</span> double<span class="token operator">?</span> decimal <span class="token operator">=</span> prefs<span class="token punctuation">.</span><span class="token function">getDouble</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'decimal'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Try reading data from the 'action' key. If it doesn't exist, returns null.</span>
<span class="token keyword">final</span> <span class="token class-name">String</span><span class="token operator">?</span> action <span class="token operator">=</span> prefs<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'action'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Try reading data from the 'items' key. If it doesn't exist, returns null.</span>
<span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token operator">?</span> items <span class="token operator">=</span> prefs<span class="token punctuation">.</span><span class="token function">getStringList</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'items'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>To remove an entry from your <code>SharedPreferences</code> instance, use the <code>remove</code> method.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">// Remove data for the 'counter' key.</span>
<span class="token keyword">final</span> success <span class="token operator">=</span> <span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'counter'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>It is worth noting that the write and delete methods are asynchronous and require the <code>await</code> keyword, but the read methods do not.</p> <p>But, what about my big chunk of JSON, you ask? What if I have an array of numbers plus a whole host of other properties that I need to save?</p> <p>The answer comes from the fact that JSON is already a String. If the data came from an API as a JSON String then you can simply use the <code>await prefs.setString()</code> method.</p> <p>If you have data that you have gathered from other locations, like a form, and you want to save that information in <code>SharedPreferences</code>, then you can put all your information into a <code>Map</code> and convert
that <code>Map</code> into a JSON String using the <code>dart:convert</code> package.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:shared_preferences/shared_preferences.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'data:convert'</span></span><span class="token punctuation">;</span>

<span class="token class-name">String</span> convertToJsonAndSave <span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">,</span> int id<span class="token punctuation">,</span> <span class="token class-name">String</span> email<span class="token punctuation">)</span> <span class="token keyword">async</span><span class="token punctuation">{</span>
  <span class="token comment">//pass in the values you want to save as a JSON string</span>
  <span class="token comment">//plus a key to use for your saved data in SharedPreferences</span>
  <span class="token comment">//access the Shared Preferences instance for your app</span>
  <span class="token keyword">final</span> prefs <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token class-name">SharedPreferences</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//build the map to hold the parameters passed to the function</span>
  <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-literal"><span class="token string">'id'</span></span><span class="token punctuation">:</span> id<span class="token punctuation">,</span>
    <span class="token string-literal"><span class="token string">'name'</span></span><span class="token punctuation">:</span> name<span class="token punctuation">,</span>
    <span class="token string-literal"><span class="token string">'email'</span></span><span class="token punctuation">:</span> email<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">//convert the Map to a JSON string</span>
  <span class="token class-name">String</span> jsonStr <span class="token operator">=</span> json<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//write the String to SharedPreferences</span>
  <span class="token keyword">await</span> prefs<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> jsonStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">//return the saved string in case it is needed elsewhere</span>
  <span class="token keyword">return</span> jsonStr<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="path-provider"><a href="#path-provider" class="header-anchor">#</a> Path Provider</h2> <p>Getting the location of files that are saved on the device requires knowing about two folders - the temp folder and the app document directory. The pub.dev package <code>path_provider</code> can get us these two
locations. We will also need the <code>dart:io</code> package to be imported.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:io'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:path_provider/path_provider.dart'</span></span><span class="token punctuation">;</span>

<span class="token keyword">void</span> <span class="token function">_getFolders</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Directory</span> tempDir <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getTemporaryDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Directory</span> appDocDir <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getApplicationDocumentDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">String</span> tempPath <span class="token operator">=</span> tempDir<span class="token punctuation">.</span>path<span class="token punctuation">;</span>
  <span class="token class-name">String</span> appDocPath <span class="token operator">=</span> appDocDir<span class="token punctuation">.</span>path<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>A useful application of the <code>path</code> and <code>path_provider</code> packages is the ability to take pictures and save them in an app folder. The Flutter Cookbook section has a recipe on how to do this.</p> <p><a href="https://docs.flutter.dev/cookbook/plugins/picture-using-camera" target="_blank" rel="noopener noreferrer">Cookbook Recipe for Camera<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="reading-and-writing-json"><a href="#reading-and-writing-json" class="header-anchor">#</a> Reading and Writing JSON</h2> <p>One of the alternatives to temporary storage via Shared Preferences is to read and write data to local JSON files. This gives you a permanent way to store information that will definitely be there the
next time the app starts.</p> <p>If you import the <code>dart:io</code> package, you will be able to work with File and Directory objects.</p> <ul><li><a href="https://api.dart.dev/stable/3.2.1/dart-io/dart-io-library.html" target="_blank" rel="noopener noreferrer">Reference to the dart:io package<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://api.dart.dev/stable/3.2.1/dart-io/File-class.html" target="_blank" rel="noopener noreferrer">Reference for the File class<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://api.dart.dev/stable/3.2.1/dart-io/Directory-class.html" target="_blank" rel="noopener noreferrer">Reference for the Directory class<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>Here is an example of a helper class for files, similar to how we create a helper class for Http functionality.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:flutter/foundation.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'package:path_provider/path_provider.dart'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:convert'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:io'</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token string-literal"><span class="token string">'dart:async'</span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">FileHelper</span> <span class="token punctuation">{</span>

  <span class="token comment">//a class for reading the contents from a data.json file</span>
  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">readContents</span><span class="token punctuation">(</span><span class="token class-name">String</span> filename<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token class-name">Directory</span> dataDir <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getApplicationDocumentsDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//find the app Documents directory</span>
    <span class="token comment">//open the file filename inside Documents/data</span>
    <span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'</span><span class="token interpolation"><span class="token punctuation">${</span><span class="token expression">dataDir<span class="token punctuation">.</span>path</span><span class="token punctuation">}</span></span><span class="token string">/data/</span><span class="token interpolation"><span class="token punctuation">${</span><span class="token expression">filename</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">;</span>

    <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//create a file object</span>
    bool doesExist <span class="token operator">=</span> <span class="token keyword">await</span> file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//check if the file actually exists</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>doesExist<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//read the contents of the file as a String</span>
      <span class="token keyword">return</span> file<span class="token punctuation">.</span><span class="token function">readAsString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span> contents<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//convert the string from the file into a Map object</span>
        <span class="token comment">//this could be a List...depends on the file.</span>
        <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token function">jsonDecode</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//now the json and data props have values</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>kDebugMode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">print</span><span class="token punctuation">(</span>contents<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'file existed and read'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//this example function returns both the String and Map versions of the file contents</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string-literal"><span class="token string">'json'</span></span><span class="token punctuation">:</span> contents<span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'data'</span></span><span class="token punctuation">:</span> data<span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catchError</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>kDebugMode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'failed to read file </span><span class="token interpolation"><span class="token punctuation">${</span><span class="token expression">err</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string-literal"><span class="token string">'json'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">''</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'data'</span></span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token comment">// throw Exception('Unable to read file.');</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">//create the file if it doesn't exist.</span>
      <span class="token comment">//the recursive property means that missing folders in the path</span>
      <span class="token comment">//will also be created.</span>
      file<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>recursive<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'created file'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token string-literal"><span class="token string">'json'</span></span><span class="token punctuation">:</span> <span class="token string-literal"><span class="token string">''</span></span><span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">'data'</span></span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token keyword">void</span><span class="token punctuation">&gt;</span></span> <span class="token function">writeData</span><span class="token punctuation">(</span><span class="token class-name">String</span> filename<span class="token punctuation">,</span> <span class="token class-name">String</span> jsonString<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token comment">//get the Documents directory inside the App</span>
    <span class="token class-name">Directory</span> dataDir <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getApplicationDocumentsDirectory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">final</span> file <span class="token operator">=</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'</span><span class="token interpolation"><span class="token punctuation">${</span><span class="token expression">dataDir<span class="token punctuation">.</span>path</span><span class="token punctuation">}</span></span><span class="token string">/data/</span><span class="token interpolation"><span class="token punctuation">${</span><span class="token expression">filename</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> file<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bool exists<span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>exists<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
          <span class="token comment">// Write JSON string to the local file</span>
          <span class="token keyword">await</span> file<span class="token punctuation">.</span><span class="token function">writeAsString</span><span class="token punctuation">(</span>jsonString<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>kDebugMode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Map data written to file: </span><span class="token interpolation"><span class="token punctuation">${</span><span class="token expression">file<span class="token punctuation">.</span>path</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>kDebugMode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'Error writing to file: </span><span class="token interpolation"><span class="token punctuation">$</span><span class="token expression">err</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">//no file</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>kDebugMode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">print</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'No such file: </span><span class="token interpolation"><span class="token punctuation">${</span><span class="token expression">file<span class="token punctuation">.</span>path</span><span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br></div></div><p>Good to note that <code>Documents</code> directory is inside the app once the app is installed. It is <strong>NOT</strong> a directory that exists inside your Flutter project structure. If you want to put files inside there
then you need to do that with code.</p> <p>Once you have the <code>Map</code> object from the JSON file you can access any of the values via their key.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token keyword">class</span> _HomeBodyState <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HomeBody</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
  <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token class-name">String</span> json <span class="token operator">=</span> <span class="token string-literal"><span class="token string">''</span></span><span class="token punctuation">;</span>

  <span class="token keyword">void</span> <span class="token function">getFileContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">async</span> <span class="token punctuation">{</span>
    <span class="token class-name">FileHelper</span> fileHelper <span class="token operator">=</span> <span class="token class-name">FileHelper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    fileHelper<span class="token punctuation">.</span><span class="token function">readContents</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'data.json'</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token keyword">dynamic</span><span class="token punctuation">&gt;</span></span> details<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data <span class="token operator">=</span> details<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'data'</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        json <span class="token operator">=</span> details<span class="token punctuation">[</span><span class="token string-literal"><span class="token string">'json'</span></span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onError</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">,</span> stackTrace<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        json <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'No file contents.'</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token metadata function">@override</span>
  <span class="token keyword">void</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">getFileContents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token comment">//Now you have access to the values via their key like</span>
<span class="token comment">// data['somekey']</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p><a href="https://github.com/prof3ssorSt3v3/shiny-dollop" target="_blank" rel="noopener noreferrer">Repo example of reading and writing JSON files<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>The <code>File</code> class also includes methods like <code>copy</code> for making copies of files, <code>rename</code> for renaming a file, <code>readAsBytes</code> for reading the data inside a binary file such as an image, <code>writeAsString</code>
and <code>writeAsBytes</code>.</p> <h2 id="providers-and-consumers"><a href="#providers-and-consumers" class="header-anchor">#</a> Providers and Consumers</h2> <p>Another way that you can save data globally and make it accessible to the rest of your app is by creating a <code>Provider</code>. This is similar to Context objects and their providers in React.</p> <p>To start with you need to add the <code>provider</code> package as a dependency in your pubspec.</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">dependencies</span><span class="token punctuation">:</span>
  <span class="token key atrule">flutter</span><span class="token punctuation">:</span>
    <span class="token key atrule">sdk</span><span class="token punctuation">:</span> flutter
  <span class="token key atrule">cupertino_icons</span><span class="token punctuation">:</span> ^1.0.2
  <span class="token key atrule">provider</span><span class="token punctuation">:</span> ^6.1.1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><a href="https://pub.dev/packages/provider/install" target="_blank" rel="noopener noreferrer">The provider package reference<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>There are several different Providers that you can use at the top of your Widget tree.</p> <ul><li><strong>MultiProvider</strong>: when you want to load several providers at the top level.</li> <li><strong>Provider</strong>: when you want to save static data at the top level.</li> <li><strong>ChangeNotifierProvider</strong>: when you want global data that you want to read and write.</li></ul> <p>The most common, and the one we will discuss here, is the <code>ChangeNotifierProvider</code>.</p> <p>Start by adding the provider as a wrapper around your App inside the <code>runApp()</code> method inside your <code>main()</code> function. It has two properties - <code>create</code> which builds the provider using a data model
class, and <code>child</code> which is your app.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">//main.dart</span>
<span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">runApp</span><span class="token punctuation">(</span>
    <span class="token class-name">ChangeNotifierProvider</span><span class="token punctuation">(</span>
      create<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name">MyDataModel</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      child<span class="token punctuation">:</span> <span class="token class-name">MyApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>The data model is a simple class that contains the member fields which hold the data that you want to access throughout the app. The member fields can be any data type that you want. Import this data
model class into <code>main.dart</code> where it is referenced in the <code>create</code> property value.</p> <p>Typically you will have private variable that hold the values and then create a getter and a setter method for each.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token comment">//my_data_model.dart</span>

<span class="token keyword">class</span> <span class="token class-name">MyDataModel</span> <span class="token keyword">extends</span> <span class="token class-name">ChangeNotifier</span> <span class="token punctuation">{</span>
  <span class="token comment">//default values</span>
  int _num <span class="token operator">=</span> <span class="token number">42</span><span class="token punctuation">;</span>
  <span class="token class-name">String</span> _name <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'Douglas'</span></span><span class="token punctuation">;</span>
  <span class="token comment">//getter and setter for _num</span>
  int <span class="token keyword">get</span> num <span class="token operator">=</span><span class="token operator">&gt;</span> _num<span class="token punctuation">;</span>
  <span class="token keyword">set</span> <span class="token function">num</span><span class="token punctuation">(</span>int value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>value <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> value <span class="token operator">&lt;</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      _num <span class="token operator">=</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//getter and setter for _name</span>
  <span class="token class-name">String</span> <span class="token keyword">get</span> name <span class="token operator">=</span><span class="token operator">&gt;</span> _name<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">set</span> <span class="token function">name</span><span class="token punctuation">(</span><span class="token class-name">String</span> value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      _name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>The data model file also needs to be imported on any file where you want to access the data, along with <code>provider</code> package import.</p> <p>On each page, or in each widget that needs to access the data from the provider we need to add a <code>Consumer()</code> widget as the first widget inside the <code>build</code> method. The <code>Consumer</code> widget needs to be
typed as the data model type - <code>Consumer&lt;MyDataModel&gt;()</code>. The <code>Consumer</code> object has one property - <code>builder</code> which accepts a function that will create the Widget tree inside the consumer.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token metadata function">@override</span>
<span class="token class-name">Widget</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token class-name">BuildContext</span> context<span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token class-name">Consumer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyDataModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>
    builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> value<span class="token punctuation">,</span> child<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token class-name">Center</span><span class="token punctuation">(</span> <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Inside the child of the <code>Consumer</code>, you can use the <code>value</code> variable from the function parameters to access the static value of any of the variables inside the data model. These are a snapshot of the
values at the point where the build function ran.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token class-name">Column</span><span class="token punctuation">(</span>
  children<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token class-name">Text</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>num<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//retrieve the value from the `get num` function in the data model</span>
    <span class="token class-name">Text</span><span class="token punctuation">(</span>value<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//retrieve the value from the `get name` function in the data model</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>If you want to access the values and also be able to update the values, then we use a different approach. We use the <code>context</code> parameter from the function, and call the <code>read</code> method to retrieve the
typed instance of the data model class. Once you have the instance of the data model then you can access any of the member fields via their getters and setters.</p> <div class="language-dart line-numbers-mode"><pre class="language-dart"><code><span class="token class-name">TextButton</span><span class="token punctuation">(</span>
  child<span class="token punctuation">:</span> <span class="token class-name">Text</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'click me'</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">final</span> model <span class="token operator">=</span> context<span class="token punctuation">.</span>read<span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">MyDataModel</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    model<span class="token punctuation">.</span>num <span class="token operator">=</span> <span class="token number">77</span><span class="token punctuation">;</span> <span class="token comment">// calling the set num method</span>
    model<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string-literal"><span class="token string">'Arthur Dent'</span></span><span class="token punctuation">;</span> <span class="token comment">//calling the set name method</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><a href="https://github.com/prof3ssorSt3v3/teacher-provider" target="_blank" rel="noopener noreferrer">Repo example of using a Provider<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="valuenotifier"><a href="#valuenotifier" class="header-anchor">#</a> ValueNotifier</h2> <p>[more notes coming soon]</p> <p><a href="https://api.flutter.dev/flutter/foundation/ValueNotifier-class.html" target="_blank" rel="noopener noreferrer">Reference page for the ValueNotifier Class<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="data-storage-options"><a href="#data-storage-options" class="header-anchor">#</a> Data Storage Options</h2> <p>There are a few other options that you can use in a Flutter app for permanent data storage. Databases that you can use in your app include:</p> <ul><li><a href="https://pub.dev/packages/sqlite3" target="_blank" rel="noopener noreferrer">SQLite<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> along with the <a href="https://pub.dev/packages/sqlite3_flutter_libs" target="_blank" rel="noopener noreferrer">SQLite libs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.hivedb.dev/#/" target="_blank" rel="noopener noreferrer">HiveDB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://isar.dev/" target="_blank" rel="noopener noreferrer">Isar DB<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>You can use any of these as a permanent LOCAL data storage solution. This is for times when you have a lot of data to manage but are not working with an external API that maintains your data.</p> <h3 id="hivedb"><a href="#hivedb" class="header-anchor">#</a> HiveDB</h3> <p>The HiveDB package works like LocalStorage in the web. It is saved across different loads of the app. It works with key-value pairs. The values can be any basic datatype - <code>int</code>, <code>double</code>, <code>bool</code>,
<code>String</code>, <code>List</code>, and <code>Map</code>.</p> <h3 id="sqlite"><a href="#sqlite" class="header-anchor">#</a> SQLite</h3> <p>Both iOS and Android phones have SQLite available on the device. The <a href="https://pub.dev/packages/sqlite3" target="_blank" rel="noopener noreferrer">https://pub.dev/packages/sqlite3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> package allows you to pass commands like <code>open()</code>,
<code>prepare()</code>, and <code>execute()</code>, to the DB on the device. It works in conjunction with the <a href="https://pub.dev/packages/sqlite3_flutter_libs" target="_blank" rel="noopener noreferrer">https://pub.dev/packages/sqlite3_flutter_libs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> package that is
needed to talk with the native libraries which are needed to run the SQLite DB.</p> <h3 id="isar-db"><a href="#isar-db" class="header-anchor">#</a> Isar DB</h3> <p>Is a more full featured database solution, like SQLite, written by the authors of HiveDB. It requires a lot more work to install, configure, and run.</p> <h2 id="what-to-do-this-week"><a href="#what-to-do-this-week" class="header-anchor">#</a> What to do this week</h2> <div class="custom-block warning"><p class="custom-block-title">TODO Things to do before next week</p> <ul><li>Finish your <a href="/wdpgf-content/deliverables/assign.html">Flutter App 2 assignment</a></li> <li>Start planning the screens for your <a href="/wdpgf-content/assignments/project.html">Flutter Final Project</a></li></ul></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">12/3/2023, 3:32:24 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/wdpgf-content/assets/js/app.cbf162c6.js" defer></script><script src="/wdpgf-content/assets/js/2.4b40a9e9.js" defer></script><script src="/wdpgf-content/assets/js/37.4259ddc9.js" defer></script><script src="/wdpgf-content/assets/js/4.c80ae3ea.js" defer></script>
  </body>
</html>
